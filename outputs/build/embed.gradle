//
// This class an universal way to embed dependencies into the final object
//

def universalEmbed(moduleSelector) {

    if ( project.plugins.hasPlugin("com.android.library") ) {
        apply plugin: 'com.kezong.fat-aar'
        fataar {
            transitive = true
        }
	if ( moduleSelector instanceof Project ) {
		if ( moduleSelector.plugins.hasPlugin("com.android.library") ) {
			project.dependencies.embed moduleSelector
		} else {
			println "${moduleSelector.path} do not have the android plugin applyed"
			project.dependencies.implementation moduleSelector
		}
	} else {
                project.dependencies.embed moduleSelector
	}
    } else {
        println("other packaging form")
    }
}



project.ext.set("universalEmbed",{ Object moduleSelector ->
        universalEmbed(moduleSelector)
})
